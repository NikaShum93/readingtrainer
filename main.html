<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Reading Trainer</title>
<link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&family=Comfortaa:wght@400;700&family=PT+Sans:wght@400;700&family=Montserrat:wght@400;700&family=Roboto:wght@400;700&family=Noto+Sans+SC:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --bgRGBA: rgba(0,0,0,0);
  --textColor: #fff;
  --titleColor: #ffd700;
  --highlightRGBA: rgba(255,215,0,1);
  --borderColor: #ffd700;
  --fontFamily: 'Comfortaa', cursive;
  --fontSize: 28px;
  --borderRadius: 18px;
}
html,body {
  height: 100%; margin: 0;
}
body {
  background: transparent;
  font-family: var(--fontFamily);
  display: flex; justify-content: center; align-items: flex-start;
  padding: 16px; color: var(--textColor);
}
#container {
  width: min(960px, 100%);
  background: var(--bgRGBA);
  border: 3px solid var(--borderColor);
  border-radius: var(--borderRadius);
  box-shadow: 0 4px 26px #0006;
  overflow: hidden;
}
.no-border #container { border: none; box-shadow: none; }
.no-bg #container { background: transparent; }
#titleArea {
  text-align: center; font-weight: 700; font-size: clamp(22px,3.2vw,34px);
  color: var(--titleColor); padding: 14px 20px 6px;
  font-family: 'UnifrakturCook', cursive;
}
#controls {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 14px; background: rgba(255,255,255,.06);
}
.spacer { flex: 1; }
button {
  background: none; border: none; cursor: pointer;
  font-size: 20px; color: var(--highlightRGBA);
  padding: 6px 8px; border-radius: 8px;
}
button:hover { background: var(--highlightRGBA); color: #222; }
button:disabled { opacity: .5; cursor: not-allowed; }
#textArea {
  padding: 20px; font-size: var(--fontSize);
  line-height: 1.5; overflow-y: auto;
}
.highlight {
  background: var(--highlightRGBA);
}
</style>
</head>
<body>
<div id="container">
  <div id="titleArea"></div>
  <div id="controls">
    <button id="playBtn">▶</button>
    <button id="pauseBtn">⏸</button>
    <button id="stopBtn">⏹</button>
    <div class="spacer"></div>
    <label>Скорость: <input type="range" id="speedControl" min="100" max="1000" value="400"></label>
  </div>
  <div id="textArea"></div>
</div>
<script>
const params = new URLSearchParams(location.search);
document.documentElement.style.setProperty('--textColor', params.get('textColor') || '#fff');
document.documentElement.style.setProperty('--titleColor', params.get('titleColor') || '#ffd700');
document.documentElement.style.setProperty('--fontFamily', params.get('fontFamily') || 'Comfortaa,cursive');
document.documentElement.style.setProperty('--fontSize', (params.get('fontSize') || 28) + 'px');
document.documentElement.style.setProperty('--borderColor', params.get('borderColor') || '#ffd700');
document.documentElement.style.setProperty('--borderRadius', (params.get('borderRadius') || 18) + 'px');

// фон с прозрачностью
const bgColor = params.get('bgColor') || '#000000';
const bgOpacity = parseFloat(params.get('bgOpacity') || 0);
const [r,g,b] = bgColor.match(/\w\w/g).map(x => parseInt(x,16));
document.documentElement.style.setProperty('--bgRGBA', `rgba(${r},${g},${b},${bgOpacity})`);

// подсветка с прозрачностью
const hlColor = params.get('highlightColor') || '#ffd700';
const hlOpacity = parseFloat(params.get('highlightOpacity') || 1);
const [hr,hg,hb] = hlColor.match(/\w\w/g).map(x => parseInt(x,16));
document.documentElement.style.setProperty('--highlightRGBA', `rgba(${hr},${hg},${hb},${hlOpacity})`);

if (params.get('border') === 'none') document.body.classList.add('no-border');
if (bgOpacity === 0) document.body.classList.add('no-bg');

document.getElementById('titleArea').textContent = params.get('title') || '';
const text = params.get('text') || '';
const words = text.split(/\s+/);
const textArea = document.getElementById('textArea');
textArea.innerHTML = words.map(w => `<span>${w} </span>`).join('');

let index = 0, timer;
function highlightWord(i) {
  document.querySelectorAll('#textArea span').forEach((span,idx) => {
    span.classList.toggle('highlight', idx === i);
  });
}
function play() {
  clearInterval(timer);
  timer = setInterval(() => {
    if (index >= words.length) { clearInterval(timer); return; }
    highlightWord(index++);
  }, parseInt(speedControl.value));
}
function pause() { clearInterval(timer); }
function stop() { clearInterval(timer); index = 0; highlightWord(-1); }

playBtn.onclick = play;
pauseBtn.onclick = pause;
stopBtn.onclick = stop;
</script>
</body>
</html>
