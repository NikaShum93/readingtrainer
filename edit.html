<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Редактор — Тренажёр по чтению by Nika Shum</title>
<style>
  body { font-family: sans-serif; padding: 20px; background: #1e1e1e; color: #fff; }
  input, textarea, select { width: 100%; margin-bottom: 10px; padding: 6px; }
  .row { display: flex; gap: 10px; }
  .row > div { flex: 1; }
  label { font-weight: bold; }
  .color-picker { width: 40px; height: 40px; border: 1px solid #ccc; cursor: pointer; }
</style>
</head>
<body>
<h1>Тренажёр по чтению — редактор</h1>

<label>Заголовок</label>
<input id="title">

<label>Текст</label>
<textarea id="text" rows="6"></textarea>

<div class="row">
  <div>
    <label>Цвет текста</label>
    <input type="color" id="textColor" value="#fff8e1">
  </div>
  <div>
    <label>Цвет подсветки</label>
    <input type="color" id="highlightColor" value="#ffd700">
  </div>
  <div>
    <label>Прозрачность подсветки</label>
    <input type="number" id="highlightOpacity" min="0" max="1" step="0.1" value="0.7">
  </div>
</div>

<div class="row">
  <div>
    <label>Фон</label>
    <input type="color" id="bgColor" value="#000000">
  </div>
  <div>
    <label>Прозрачность фона</label>
    <input type="number" id="bgOpacity" min="0" max="1" step="0.05" value="0.25">
  </div>
  <div>
    <label>Цвет рамки</label>
    <input type="color" id="borderColor" value="#ffd700">
  </div>
  <div>
    <label>Скругление рамки</label>
    <input type="number" id="borderRadius" min="0" max="1000" value="18">
  </div>
</div>

<button id="publishBtn">Опубликовать</button>
<textarea id="iframeCode" rows="3" readonly></textarea>

<script>
const serverUrl = "https://server-kjnn.onrender.com/publish";

document.getElementById('publishBtn').addEventListener('click', async () => {
  const payload = {
    title: document.getElementById('title').value,
    text: document.getElementById('text').value
  };

  const res = await fetch(serverUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  });

  const data = await res.json();
  if (data.success && data.file) {
    const iframe = `<iframe src="https://nikashum93.github.io/readingtrainer/main.html?data=${encodeURIComponent(data.file)}&textColor=${encodeURIComponent(document.getElementById('textColor').value)}&highlightColor=${encodeURIComponent(document.getElementById('highlightColor').value)}&highlightOpacity=${document.getElementById('highlightOpacity').value}&bgColor=${encodeURIComponent(document.getElementById('bgColor').value)}&bgOpacity=${document.getElementById('bgOpacity').value}&borderColor=${encodeURIComponent(document.getElementById('borderColor').value)}&borderRadius=${document.getElementById('borderRadius').value}" width="900" height="520" style="border:none;border-radius:16px;overflow:hidden;"></iframe>`;
    document.getElementById('iframeCode').value = iframe;
  } else {
    alert('Ошибка публикации');
  }
});
</script>
</body>
</html>
